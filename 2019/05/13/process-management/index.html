<!DOCTYPE html>
<!--[if lte IE 8 ]>
<html class="ie" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-US" lang="en-US">
<![endif]-->
<!--[if (gte IE 9)|!(IE)]><!-->
<!--
***************  *      *     *
      8          *    *       *
      8          *  *         *
      8          **           *
      8          *  *         *
      8          *    *       *
      8          *      *     *
      8          *        *   ***********    -----Theme By Kieran(http://go.kieran.top)
-->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="zh-CN" lang="zh-CN">
<!--<![endif]-->

<head>
  <title>process_management | Hexo</title>
  <!-- Meta data -->
    <meta http-equiv="Content-Type" content="text/html" charset="UTF-8" >
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="generator" content="Hexo">
    <meta name="author" content="John Doe">
    <meta name="description" content="" />
    <meta name="keywords" content="" />

    <!-- Favicon, (keep icon in root folder) -->
    <link rel="Shortcut Icon" href="/img/favicon.ico" type="image/ico">

    <link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom+xml">
    <link rel="stylesheet" href="/css/all.css" media="screen" type="text/css">
    
    <link rel="stylesheet" href="/highlightjs/vs.css" type="text/css">
    

    <!--[if IE 8]>
    <link rel="stylesheet" type="text/css" href="/css/ie8.css" />
    <![endif]-->

    <!-- jQuery | Load our jQuery, with an alternative source fallback to a local version if request is unavailable -->
    <script src="/js/jquery-1.11.1.min.js"></script>
    <script>window.jQuery || document.write('<script src="js/jquery-1.11.1.min.js"><\/script>')</script>

    <!-- Load these in the <head> for quicker IE8+ load times -->
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
    <script src="/js/html5shiv.min.js"></script>
    <script src="/js/respond.min.js"></script>
    <![endif]-->

  
  
  

  <style>.col-md-8.col-md-offset-2.opening-statement img{display:none;}</style>
</head>

<!--
<body class="post-template">
-->
<body id="index" class="lightnav animsition">

      <!-- ============================ Off-canvas navigation =========================== -->

    <div class="sb-slidebar sb-right sb-style-overlay sb-momentum-scrolling">
        <div class="sb-close" aria-label="Close Menu" aria-hidden="true">
            <img src="/img/close.png" alt="Close">
        </div>
        <!-- Lists in Slidebars -->
        <ul class="sb-menu">
            <li><a href="/" class="animsition-link" title="Home">Home</a></li>
            <li><a href="/archives" class="animsition-link" title="archive">archives</a></li>
            <!-- Dropdown Menu -->
			 
            <li>
                <a class="sb-toggle-submenu">Works<span class="sb-caret"></span></a>
                <ul class="sb-submenu">
                    
                        <li><a href="/" target="_BLANK" class="animsition-link">AAA</a></li>
                    
                        <li><a href="/atom.xml" target="_BLANK" class="animsition-link">BBB</a></li>
                    
                </ul>
            </li>
            
            
        	<li>
        		<a class="sb-toggle-submenu">Categories<span class="sb-caret"></span></a>
            	<ul class="sb-submenu">
				  	
				    <li><a href="/categories/Linux/" class="animsition-link">Linux<small>(1)</small></a></li>
				    
				    <li><a href="/categories/algorithm/" class="animsition-link">algorithm<small>(1)</small></a></li>
				    
				    <li><a href="/categories/cppdetails/" class="animsition-link">cppdetails<small>(1)</small></a></li>
				    
				    <li><a href="/categories/project-record/" class="animsition-link">project record<small>(4)</small></a></li>
				    
				    <li><a href="/categories/scientific-research/" class="animsition-link">scientific research<small>(2)</small></a></li>
				    
				    <li><a href="/categories/theory/" class="animsition-link">theory<small>(2)</small></a></li>
				    
				</ul>
        	</li>
			
            
            <li>
                <a class="sb-toggle-submenu">Links<span class="sb-caret"></span></a>
                <ul class="sb-submenu">
                    
                    <li><a href="http://go.kieran.top/" class="animsition-link">Kieran</a></li>
                    
                    <li><a href="http://domain.com/" class="animsition-link">Name</a></li>
                    
                </ul>
            </li>
            
        </ul>
        <!-- Lists in Slidebars -->
        <ul class="sb-menu secondary">
            
            <li><a href="/about.html" class="animsition-link" title="about">About</a></li>
            <li><a href="/atom.xml" class="animsition-link" title="rss">RSS</a></li>
        </ul>
    </div>
    
    <!-- ============================ END Off-canvas navigation =========================== -->

    <!-- ============================ #sb-site Main Page Wrapper =========================== -->

    <div id="sb-site">
        <!-- #sb-site - All page content should be contained within this id, except the off-canvas navigation itself -->

        <!-- ============================ Header & Logo bar =========================== -->

        <div id="navigation" class="navbar navbar-fixed-top">
            <div class="navbar-inner">
                <div class="container">
                    <!-- Nav logo -->
                    <div class="logo">
                        <a href="/" title="Logo" class="animsition-link">
                         <img src="/img/logo.png" alt="Logo" width="35px;"> 
                        </a>
                    </div>
                    <!-- // Nav logo -->
                    <!-- Info-bar -->
                    <nav>
                        <ul class="nav">
                            <li><a href="/" class="animsition-link">Hexo</a></li>
                            <li class="nolink"><span>Always </span>Creative.</li>
                            
                            <li><a href="https://github.com/" title="Github" target="_blank"><i class="icon-github"></i></a></li>
                            
                            
                            <li><a href="https://twitter.com/" title="Twitter" target="_blank"><i class="icon-twitter"></i></a></li>
                            
                            
                            <li><a href="https://www.facebook.com/" title="Facebook" target="_blank"><i class="icon-facebook"></i></a></li>
                            
                            
                            <li><a href="https://google.com/" title="Google-Plus" target="_blank"><i class="icon-google-plus"></i></a></li>
                            
                            
                            <li><a href="http://weibo.com/" title="Sina-Weibo" target="_blank"><i class="icon-sina-weibo"></i></a></li>
                            
                            <li class="nolink"><span>Welcome!</span></li>
                        </ul>
                    </nav>
                    <!--// Info-bar -->
                </div>
                <!-- // .container -->
                <div class="learnmore sb-toggle-right">More</div>
                <button type="button" class="navbar-toggle menu-icon sb-toggle-right" title="More">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar before"></span>
                <span class="icon-bar main"></span>
                <span class="icon-bar after"></span>
                </button>
            </div>
            <!-- // .navbar-inner -->
        </div>

        <!-- ============================ Header & Logo bar =========================== -->

</div>
      
<section id="intro">
    <div class="container">
        <div class="row col-md-offset-2">
            <div class="col-md-8">
    			<span class="post-meta">
      <time datetime="2019-05-13T05:50:29.000Z" itemprop="datePublished">
          2019-05-13
      </time>
    
    
    | 
    <a href="/tags/os/">os</a>,
    
    <a href="/tags/process-management/">process management</a>
    
    
</span>
                <h1>process_management</h1>
            </div>
        </div>
        <div class="col-md-8 col-md-offset-2">
      		<h1 id="Linux-Programming-—-Process-management"><a href="#Linux-Programming-—-Process-management" class="headerlink" title="Linux Programming — Process management"></a>Linux Programming — Process management</h1><h2 id="Forward"><a href="#Forward" class="headerlink" title="Forward"></a>Forward</h2><p>It is really excited that we start to get touch in Linux Programming. It’s truely different from my old coding life, not like implementing a complex library management system or focusing on a hard algorithm problem. It’s more about computer itself, i mean, we are talking about process how a computer really works. And actually this is much complex than a library management system and much mental than algorithm problems. And you can finally tell others you major in CS or CE, not SE after experiencing these.</p>
<h2 id="The-very-first-task"><a href="#The-very-first-task" class="headerlink" title="The very first task"></a>The very first task</h2><p>Here’s the description of the task in Chinese:</p>
<p><strong>每个进程都执行自己独立的程序，打印自己的pid，每个父进程打印其子进程的pid;</strong></p>
<p>and the picture:</p>
<p><img src="task.png" alt="task"></p>
<p>I had to say it’s really confusing: does parent have to print son2’s pid? If it does, then this task would be quiet difficult as the very first task. Most of my classmates thought this way or, never gave a thought on it, and soon they finished their work. Only a bit idiots like me, made it really complex. But here is my principle:</p>
<p><strong>Make things easy for your client while making it hard for yourself. Never waste a chance of challenging yourself.</strong></p>
<p>So next i will do in my complex way.</p>
<h2 id="PID-and-fork"><a href="#PID-and-fork" class="headerlink" title="PID and fork"></a>PID and fork</h2><p>what is PID:</p>
<ul>
<li>Process Identification</li>
<li>unique and binded to process</li>
</ul>
<p>what is fork:</p>
<ul>
<li>subprocess <strong>copy</strong> parent process.</li>
<li>in subprocess, fork return 0. </li>
<li>in parent process, fork reuturn <strong>subprocess pid</strong></li>
<li>if error, return -1;</li>
</ul>
<p><img src="fork.png" alt="fork"></p>
<p>remember to include header file:</p>
<pre><code>#include &quot;unistd.h&quot;    //os api access
#include &quot;sys/types.h&quot;    //so you can use pid_t
</code></pre><p>so with a little time, we can finish the code below:</p>
<pre><code>#include &lt;stdio.h&gt;
#include &lt;unistd.h&gt;
#include &lt;sys/types.h&gt;

int main(){
    pid_t subpid = fork();
    if(subpid == 0){    //subprocess 
        pid_t subsubpid = fork(); 
        if(subsubpid == 0){    //subsubprocess
                printf(&quot;subsubpro&apos;s pid is: %d.\n&quot;, getpid());
        }
        else{
            printf(&quot;subpro&apos;s pid is: %d.\n&quot;, getpid());
            printf(&quot;subpro&apos;s subpro&apos; pid is %d.\n&quot;, subsubpid);
        }
    }
    else{    //parent process
        printf(&quot;parents&apos; pid is %d.\n&quot;, getpid());
         printf(&quot;parents&apos; subpro&apos; pid is %d.\n&quot;, subpid);
    }
    return 0;
}
</code></pre><p>and here is the result:<img src="layer_by_layer.png" alt="result1"></p>
<h2 id="use-pipe"><a href="#use-pipe" class="headerlink" title="use pipe"></a>use pipe</h2><p>Codes above didn’t move the biggest stone on our way: how parent print son2’s PID? Use pipe like this way:</p>
<pre><code>int fd[2];
pipe(fd);
...
{    // in subprocess
    ...
    close(fd[0]);    // close parents&apos; read
    write(fd[1], &amp;subsubpid, sizeof(pid_t));    //write pid        
    ...
}
...
{    // in parent process
    ...
    close(fd[1]);    // close child&apos;s write
    read(fd[0], &amp;subsubpid, sizeof(pid_t));    //read from pipe
    printf(&quot;parents&apos; subpro&apos; subpro&apos; pid is %d.\n&quot;, subsubpid);
    ...
}
</code></pre><p>You can see we thought really carefully by using function <strong>close()</strong>, intending to maintain some kind of order.</p>
<p>Here’s the code and the result:</p>
<pre><code>#include &lt;stdio.h&gt;
#include &lt;unistd.h&gt;
#include &lt;sys/types.h&gt;

int main(){
    int fd[2];
    pipe(fd);
    pid_t subpid = fork();
    pid_t subsubpid;
    if(subpid == 0){
        pid_t subsubpid = fork(); 
        if(subsubpid == 0){
                printf(&quot;subsubpro&apos;s pid is: %d.\n&quot;, getpid());
        }
        else{
            printf(&quot;subpro&apos;s pid is: %d.\n&quot;, getpid());
            printf(&quot;subpro&apos;s subpro&apos; pid is %d.\n&quot;, subsubpid);
            close(fd[0]);    // close parents&apos; read
            write(fd[1], &amp;subsubpid, sizeof(pid_t));    //write pid
        }
    }
    else{
        printf(&quot;parents&apos; pid is %d.\n&quot;, getpid());
         printf(&quot;parents&apos; subpro&apos; pid is %d.\n&quot;, subpid);
        close(fd[1]);    // close child&apos;s write
        read(fd[0], &amp;subsubpid, sizeof(pid_t));    //read from pipe
        printf(&quot;parents&apos; subpro&apos; subpro&apos; pid is %d.\n&quot;, subsubpid);
    }
    return 0;
}    
</code></pre><p><img src="before_wait.png" alt="pipe"></p>
<p>It’s surprise to see large negative number above, also disappointed to find that your efforts to main order in vain. Be patient and success is close.</p>
<h2 id="parent-wait"><a href="#parent-wait" class="headerlink" title="parent wait"></a>parent wait</h2><p>To make process in order, we need something efficient: function <strong>wait()</strong></p>
<p>To use wait, you may alse need a <strong>status</strong>:</p>
<pre><code>#include &lt;stdio.h&gt;
#include &lt;unistd.h&gt;
#include &lt;sys/types.h&gt;
#include &lt;wait.h&gt;

int main(){
    int status = -1;
    int fd[2];
    pipe(fd);
    pid_t subpid = fork();
    pid_t subsubpid;
    if(subpid == 0){
        pid_t subsubpid = fork(); 
        if(subsubpid == 0){
                printf(&quot;subsubpro&apos;s pid is: %d.\n&quot;, getpid());
        }
        else{
            printf(&quot;subpro&apos;s pid is: %d.\n&quot;, getpid());
            printf(&quot;subpro&apos;s subpro&apos; pid is %d.\n&quot;, subsubpid);
            close(fd[0]);    // close parents&apos; read
            write(fd[1], &amp;subsubpid, sizeof(pid_t));    //write pid
            WEXITSTATUS(status);
        }
    }
    else{
        wait(&amp;status);
        printf(&quot;parents&apos; pid is %d.\n&quot;, getpid());
         printf(&quot;parents&apos; subpro&apos; pid is %d.\n&quot;, subpid);
        close(fd[1]);    // close child&apos;s write
        read(fd[0], &amp;subsubpid, sizeof(pid_t));    //read from pipe
        printf(&quot;parents&apos; subpro&apos; subpro&apos; pid is %d.\n&quot;, subsubpid);
    }
    return 0;
}    
</code></pre><p>Finally we get what we want!:</p>
<p><img src="after_wait.png" alt="wait"></p>
<h2 id="epilogue"><a href="#epilogue" class="headerlink" title="epilogue"></a>epilogue</h2><p>Hope this blog is helpful, and wish i can use vim as proficiently as sublime someday… </p>

            <div class="clearfix"></div>
            <hr class="nogutter">
        </div>
        <nav class="m-pagination col-md-8 col-md-offset-2 col-sm-24" role="pagination">
    
    
    <a class="pull-right" href="/2019/05/12/normal-form/">
        normal form →
    </a>
    
</nav>

        <div class="col-md-8 col-md-offset-2 col-sm-24"><script type="text/javascript">
  /**
   * 搜狐畅言
   */

  /*
  document.write('<div id="SOHUCS" sid="' + window.location.pathname.slice(1) + '" ></div>');

  window.onload = function () {
    (function () {
      var appid = 'cytXXXX';
      var conf = 'prod_xxxxxxxxxxxxxxxxx';
      var width = window.innerWidth || document.documentElement.clientWidth;
      var loadJs = function (d, a, id) {
        var c = document.getElementsByTagName("head")[0] || document.head || document.documentElement;
        var b = document.createElement("script");
        b.setAttribute("type", "text/javascript");
        b.setAttribute("charset", "UTF-8");
        b.setAttribute("src", d);
        if (id) {
          b.setAttribute("id", id);
        }
        if (typeof a === "function") {
          if (window.attachEvent) {
            b.onreadystatechange = function () {
              var e = b.readyState;
              if (e === "loaded" || e === "complete") {
                b.onreadystatechange = null;
                a()
              }
            }
          } else {
            b.onload = a
          }
        }
        c.appendChild(b)
      };

      loadJs("https://changyan.sohu.com/upload/changyan.js", function () {
        window.changyan.api.config({
          appid: appid,
          conf: conf
        })
      });
    })();
  }
  */

</script>
</div>
    </div>
</section>


      
<!-- ============================ Footer =========================== -->

<footer>
    <div class="container">
            <div class="copy">
                <p>
                    &copy; 2014<script>new Date().getFullYear()>2010&&document.write("-"+new Date().getFullYear());</script>, Content By John Doe. All Rights Reserved.
                </p>
                <p>Theme By <a href="//go.kieran.top" style="color: #767D84">Kieran</a></p>
            </div>
            <div class="social">
                <ul>
                    
                    <li><a href="https://github.com/" title="Github" target="_blank"><i class="icon-github"></i></a>&nbsp;</li>
                    
                    
                    <li><a href="https://twitter.com/" title="Twitter" target="_blank"><i class="icon-twitter"></i></a>&nbsp;</li>
                    
                    
                    <li><a href="https://www.facebook.com/" title="Facebook" target="_blank"><i class="icon-facebook"></i></a>&nbsp;</li>
                    
                    
                    <li><a href="https://google.com/" title="Google-Plus" target="_blank"><i class="icon-google-plus"></i></a>&nbsp;</li>
                    
                    
                    <li><a href="http://weibo.com/" title="Sina-Weibo" target="_blank"><i class="icon-sina-weibo"></i></a>&nbsp;</li>
                    
                </ul>
            </div>
            <div class="clearfix"> </div>
        </div>
</footer>

<!-- ============================ END Footer =========================== -->
      <!-- Load our scripts -->
<!-- Resizable 'on-demand' full-height hero -->
<script type="text/javascript">
    var resizeHero = function () {
        var hero = $(".cover,.heightblock"),
            window1 = $(window);
        hero.css({
            "height": window1.height()
        });
    };

    resizeHero();

    $(window).resize(function () {
        resizeHero();
    });
</script>
<script src="/js/plugins.min.js"></script><!-- Bootstrap core and concatenated plugins always load here -->
<script src="/js/scripts.js"></script><!-- Theme scripts -->


<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
$('#intro').find('img').each(function(){
  var alt = this.alt;

  if (alt){
    $(this).after('<span class="caption" style="display:none">' + alt + '</span>');
  }

  $(this).wrap('<a href="' + this.src + '" title="' + alt + '" class="fancybox" rel="gallery" />');
});
(function($){
  $('.fancybox').fancybox();
})(jQuery);
</script>



      
</body>
</html>
